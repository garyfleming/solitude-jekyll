<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Solitude - Happenings</title>
  <meta name="author" content="Solitude" />
  <meta name="twitter:widgets:csp" content="on" />
  <meta name="description" content="The blog of Solitude" />
  <link rel="canonical" href="http://solitude.vkps.co.uk/page/30/" />

  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Solitude" href="http://solitude.vkps.co.uk/atom.xml" />

  <link rel="stylesheet" href="/assets/css/all.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha256-k2/8zcNbxVIh5mnQ52A0r3a6jAgMGxFJFE2707UxGCk= sha512-ZV9KawG2Legkwp3nAlxLIVFudTauWuBpC10uEafMHYL0Sarrz5A7G79kXh5+5+woxQ5HM559XX2UZjMJ36Wplg==" crossorigin="anonymous">
</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
      <nav>
  <h1><a href="/">Solitude</a></h1>
  <a href="/">
    
    <img src="/assets/images/tree-160.jpg" id="solitude-logo" alt="Solitude logo"/>
    
  </a>
  <div id="bio">
    <p>Technology. Code. Living relentlessly in the real world.</p>
  </div>
  <nav>
    <ul>
      <li><a href="/about/">About</a></li>
      <li><a href="/Archives/">Archives</a></li>
    </ul>
  </nav>
  <div id="social">
    Follow me:
<div id="stalker">
  

  

  

  

  

  
  <a title="garyfleming on Twitter" href="https://twitter.com/garyfleming">
    <i class="fa fa-twitter-square"></i>
  </a>
  

  

  

  

  

  

  
  <a title="Atom feed" id="atom" href="/feed/">
    <i class="fa fa-rss-square"></i>
  </a>
  
</div>

  </div>
  
</nav>

    </div>

    <div class="eleven columns content">
      <div id="home">
  <h2><i class="fa fa-bookmark"></i> Happenings</h2>

  
  <div class="postcontainer">
  <h3><a href="/Archives/2010/06/21/film-fight-2010-may/">Film Fight 2010: May</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>It may be a few weeks late, but the Film Fight for May is an extremely light one with only one film.</p>

<p><strong>Four Lions</strong> is another interesting piece of comedy from Chris Morris. The premise is a comedy that follows a few would-be suicide bombers from their hometowns to training camps and back. Rather than being mean-spirited or relying on controversy, what we get is a great British farce as we see how absolutely incompetent most of the crew are. There are a few stark moments, but it’s almost entirely silly, poking fun at the idea of the bombers and their ridiculous scheme. (See <a href="http://twitter.com/garyfleming/status/13662546747">my Four Lions Twitter review</a>).</p>

<p>And the winner is… <strong>Four Lions</strong>. Obviously.</p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
  <div class="postcontainer">
  <h3><a href="/Archives/2010/05/09/film-fight-2010-april/">Film Fight 2010: April</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>A reasonably busy April at the cinemas has meant another bigger-than-usual Film Fight, with five films.</p>

<p><strong>Kick-Ass</strong> is a ridiculous film. It’s an absurd premise (a kid decides to become a super-hero and finds out he isn’t the first one to try it), that holds together remarkably well when paired up with intentionally over-the-top violence in a pseudo-comic book world. It’s bloody, and goes quite far at times (mostly when it uses Hit Girl), but manages to pull it off by making it clear that this is entertainment and clearly straight out of a graphic novel. While the story isn’t anything to right home about, and it has some cringeworthy moments, it remains entertaining to the end. (See <a href="http://twitter.com/garyfleming/status/11537585568">my Kick Ass Twitter review</a>).</p>

<p><strong>Green Zone</strong> sees Matt Damon team back up with Paul Greengrass, in a plot pulled straight from a Tom Clancy novel. Yes, it’s the usual military-complex, conspiracy nonsense, but it is reasonably fun. It works best when letting Damon get into the action set-pieces and starts to wane whenever it goes near the reasons for the conspiracy. For the most part, a reasonable balance is found to keep things moving forward. Where it really falls down is in the comparisons that have been drawn to the Bourne trilogy. Even on the action side, this is a much more relaxed affair than the impossibly well-developed skills of Damon’s previous super-spy character. Worth seeing. (See <a href="http://twitter.com/garyfleming/status/11656294361">my Green Zone Twitter review</a>).</p>

<p>Comedy, good comedy, can be painfully uncomfortable. Either bringing up subjects that most people consider taboo to shed some light on them or by poking fun at preconceptions. It was surprising to see that <strong>Crying With Laughter</strong> managed to blend that discomfort so well into a fairly dark thriller so well. It tells the story of a stand-up who is at his make-or-break point, going further and darker with every show, as he bumps into someone he used to know who will give him an incredible story to tell. At moments the film is incredibly funny, and at others it’s horrific as you discover the painful memories that full the lead. A few of the minor characters aside, this is a fantastic film; that brings together two kinds of unease, and produces an excellent story from them. Highly recommended. (See <a href="http://twitter.com/garyfleming/status/12416359447">my Crying with Laughter Twitter review</a>).</p>

<p>Mike Judge has an incredibly strong legacy with Beavis &amp; Butthead, King of the Hill, Idiocracy and his classic, Office Space. It’s with that in mind that it’s fairly surprising his new movie, <strong>Extract</strong>, just isn’t that funny. There are some great moments and some well-observed characters (David Koechner delivers another great small part), but a lot of it falls flat. It’s not awful, but it is entirely forgettable. (See <a href="http://twitter.com/garyfleming/status/12829983754">my Extract Twitter review</a>).</p>

<p>Finally, Todd Solondz returns to the characters he introduced in Happiness 12 years ago, recasting them all in a pseudo-sequel, <strong>Life During Wartime</strong>. If you liked the first film, you’ll wish he hadn’t. It has a scant few jokes that hit the familiar territory of awkwardness that Solondz thrives in, but much of it doesn’t work. As a whole, the film lacks any real cohesion, with fairly uninteresting characters not really doing much or saying anything of real value. There’s not much of a theme, just a series of moments that hang together poorly. It’s a shame because a few of them work incredibly well: the scene where Billy is reunited with his father is absolutely gripping. A quite disappointing effort. (See <a href="http://twitter.com/garyfleming/status/13030912203">my Life During Wartime Twitter review</a>).</p>

<p>And the winner is… <strong>Crying With Laughter</strong>, for walking the fine line between horrific and funny extremely well.</p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
  <div class="postcontainer">
  <h3><a href="/Archives/2010/04/22/modern-java-jpa/">Modern Java: JPA</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>In the previous post, I <a href="http://solitude.vkps.co.uk/Archives/2010/04/11/modern-java-validation/">showed how JSR-303 is making validation neater.</a> I concluded that article with the Person bean looking like this:</p>

<pre class="brush: java; title: ; notranslate" title="">@Data
public class Person {
    @NotNull @Size(min=1)
    private String firstName;
    @NotNull @Size(min=1)
    private String lastName;
    @Min(18)
    private int age;
}
</pre>

<p>If we know we have a valid bean, at some point we probably want to persist it so we can use it again. I won’t waste time on spelling out how much boilerplate code is written for raw JDBC calls as most developers have moved a level of abstraction up from that anyway, with great tools like <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.html">Spring’s JdbcTemplate</a>.</p>

<p>I also won’t go deeply into the history of ORM in Java, as a lot has already been said. The Java Persistence API (JPA) standardised fairly sensible ideas about how ORM should work, starting from real implementations (primarily <a href="http://www.hibernate.org/">Hibernate</a>) and pulling together the main concepts. To prepare a bean for JPA persistence, we merely need to add an @Entity annotation and specify an @Id column (which I’m going to have to add to Person):</p>

<pre class="brush: java; title: ; notranslate" title="">@Data @Entity
public class Person {
    @Id
    private Long id;
    @NotNull @Size(min=1)
    private String firstName;
    @NotNull @Size(min=1)
    private String lastName;
    @Min(18)
    private int age;
}
</pre>

<p>And that’s it. You can then use a properly configured EntityManager to persist() your class (the configuration details are largely implementation specific, but relatively lightweight).</p>

<p>There are a lot of options available to configure exactly how an entity should be persisted when passed into an EntityManager. Again, I won’t cover them all, but it’s generally considered best practice to state your table and column names explicitly (rather than relying on convention, as I have above) and you’ll often want to make use of the built-in optimistic concurrency support to stop multiple changes happening at once.</p>

<pre class="brush: java; title: ; notranslate" title="">@Data @Entity @Table(name="people")
public class Person {
    @Id @Column(name="id");
    private Long id;

    @Version @Column(name="version")
    private int version;

    @NotNull @Size(min=1)
    @Column(name="first_name")
    private String firstName;

    @NotNull @Size(min=1)
    @Column(name="last_name")
    private String lastName;

    @Min(18)
    @Column(name="age")
    private int age;
}
</pre>

<p>As a bonus, if you use a JPA2 provider AND have a JSR-303 validation implementation in your classpath, the default behaviour will be for your bean to get validated before it gets persisted, so you wouldn’t have to explicitly call the validator any more.</p>

<p>Again, there’s a lot more to be said about JPA, and the use cases that it supports (I haven’t touched on object-graphs, embedded collections, or the Java persistence query language), but you should have a flavour for it.</p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
  <div class="postcontainer">
  <h3><a href="/Archives/2010/04/11/modern-java-validation/">Modern Java: Validation</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>In the previous post on Modern Java, I showed how <a href="/Archives/2010/04/05/modern-java-lombok/">Lombok is making Java beans more concise</a>. In that post, I showed how we would end up with the following class:</p>

<pre class="brush: java; title: ; notranslate" title="">@Data
public class Person {
    private String firstName;
    private String lastName;
    private int age;
}
</pre>

<p>Given an instance of that class by binding data from a web form, a database or some other data source, a fairly common requirement is to validate it against a series of rules and constraints.</p>

<p>For example, if we assume “age” is the number of years the person being described has been alive, we know that it must be zero or greater. Depending on our application we may also know that it’s above a minimum age (18, say) and is extremely likely to be below a maximum age (there are very few people over 100, and none over 120).</p>

<p>A few years ago, you would have to write a custom piece of code to validate simple rules in all of your domain classes. These would typically be specific to the class in question, running through a series of explicit checks, and produce a list of errors found. While this worked, it was often verbose and tightly-coupled to each domain class. It might look something like this:</p>

<pre class="brush: java; title: ; notranslate" title="">public Collection&lt;Error&gt; validate(Person person) {
  Collection&lt;Error&gt; errors = new LinkedList&lt;Error&gt;();
  if(person.getAge() == null) {
    errors.add(new Error("Age cannot be null"));
  }
  if(person.getAge() &lt; 0) {
    errors.add(new Error("Age must be greater than zero"));
  }
  if(person.getAge() &gt; 120) {
    errors.add(new Error("Unlikely to be a real age"));
  }
  return errors;
}
</pre>

<p>Note that we’re only validating a few rules on one field, and it’s already quite verbose. If we validated every field on an object and the interdependencies between them, then we would have a lot of code.</p>

<p>Both the <a href="http://www.springsource.org/">Spring Framework</a> and <a href="http://hibernate.org/">Hibernate</a> had come up with their own ways of making writing and integrating validation logic a little easier, but now validation has been standardised in <a href="http://jcp.org/en/jsr/detail?id=303">JSR-303</a>. The reference implementation is Hibernate Validator 4, and it’s a great starting point, but most uses of JSR-303 will be relatively agnostic of the implementation. Since this is a finalised specification, you can also make use of it today.</p>

<p>For our Person class above, let’s add the following constraints:</p>

<ul>
  <li>Age must be 18 or more</li>
  <li>First and last name must be set i.e. they can’t be left null</li>
  <li>First and last name must have at least one character in them</li>
</ul>

<p>To implement these rules, we need only add a few new annotations, using standard constraints:</p>

<pre class="brush: java; title: ; notranslate" title="">@Data
public class Person {
    @NotNull @Size(min=1)
    private String firstName;
     @NotNull @Size(min=1)
    private String lastName;
    @Min(18)
    private int age;
}
</pre>

<p>You then create a Validator instance (how you do this will depend on your chosen implementation), and pass the class in for validation:</p>

<pre class="brush: java; title: ; notranslate" title="">Set&lt;ConstraintViolation&lt;Person&gt;&gt; errors = validator.validate(person);
</pre>

<p>All the validation is then handled for you, reducing the amount of code and making your bean classes very clearly state the constraints under which they operate. You know a first name is not just any old nullable string by just looking at the class, and you know ages have limitations in your particular domain of interest. The code is more expressive and concise, and that’s a very good thing.</p>

<p>There’s a lot more to the JSR-303 specification, and it has all the features you might want. While I fully intend to go into the other features at another time, I’d strongly recommend browsing the spec to see some of the power and flexibility available to you.</p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
  <div class="postcontainer">
  <h3><a href="/Archives/2010/04/05/modern-java-lombok/">Modern Java: Lombok</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>In recent months, I’ve been looking at a lot of new Java libraries to see what I’d like to use and what I think still has a way to go. I’ll be posting about them all in due course but I wanted to mention <a href="http://projectlombok.org/">Lombok</a> first.</p>

<p>First, a class:</p>

<pre class="brush: java; title: ; notranslate" title="">public class Person {
    private String firstName;
    private String lastName;
    private int age;

    public String getFirstName() {
      return firstName;
    }
    public void setFirstName(String firstName) {
      this.firstName = firstName;
    }
    public String getLastName() {
      return lastName;
    }
    public void setLastName(String lastName) {
      this.lastName = lastName;
    }
    public int getAge() {
      return age;
    }
    public void setAge(int age) {
      this.age = age;
    }
}
</pre>

<p>The problem here is that everything after <code class="highlighter-rouge">public int age</code> is predictable and verbose; you know that this is a Java bean class and that the fields are likely going to have getters and setters just like those provided. If we know exactly what to expect, shouldn’t the compiler take care of that for us rather than having us specify more code? Less code is often cleaner code.</p>

<p>For several years now, people have been asking for the idea of <a href="http://weblogs.java.net/blog/rbair/archive/2007/01/properties_in_j.html">properties in Java</a>. That is, being able to define fields and automatically having standard getters and setters defined, without having to clutter the class file with boilerplate. The most common (and reasonable) response for avoiding this is that it would be difficult to implement without affecting backwards compatibility.</p>

<p>While those proposals are pretty much dead at the moment, Lombok saves us from having to specify our standard getters and setters by marking our classes as beans and then jumping into the compilation process to make sure getters and setters are generated. The above code becomes:</p>

<pre class="brush: java; title: ; notranslate" title="">@Data
public class Person {
    private String firstName;
    private String lastName;
    private int age;
}
</pre>

<p>That’s right: the 18 or so lines of getter/setter boilerplate are replaced by the tiny little <a href="http://projectlombok.org/features/Data.html">@Data</a> annotation, and the code is much cleaner. As a bonus, @Data also generates a <code class="highlighter-rouge">toString()</code>, an <code class="highlighter-rouge">equals()</code> and a <code class="highlighter-rouge">hashCode()</code>. You can use the other Lombok annotations to tweak the behaviour, but this is what most people are going to want.</p>

<p>Also of note is the <a href="http://projectlombok.org/features/Cleanup.html">@Cleanup annotation</a>, which provides automatic resource management (ARM) for using input/output streams. While this will be less essential if ARM arrives in Java 7, it’s a handy little helper for the time being.</p>

<p>While Lombok can’t make bad code good, it can make verbose code a lot more succinct.</p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
</div>



<!-- Pagination links -->
<div class="postnavigation">
  
    <a href="/page/29" class="previous">&laquo; Previous</a>
  
  
    <a href="/page/31" class="next">Next &raquo;</a>
  
</div>


      <div class="footer">
        <div class="disclaimer">
  

  <p>
    © Solitude, 2003-20 &mdash; built with <a href="http://jekyllrb.com/">Jekyll</a>, using <a href="https://github.com/swanson/lagom">Lagom</a> as a base theme.
  </p>
</div>
      </div>
    </div>
  </div>


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11493178-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
