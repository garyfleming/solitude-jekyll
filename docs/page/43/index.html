<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Solitude - Happenings</title>
  <meta name="author" content="Solitude" />
  <meta name="twitter:widgets:csp" content="on" />
  <meta name="description" content="The blog of Solitude" />
  <link rel="canonical" href="https://solitude.vkps.co.uk/page/43/" />

  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Solitude" href="https://solitude.vkps.co.uk/atom.xml" />

  <link rel="stylesheet" href="/assets/css/all.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha256-k2/8zcNbxVIh5mnQ52A0r3a6jAgMGxFJFE2707UxGCk= sha512-ZV9KawG2Legkwp3nAlxLIVFudTauWuBpC10uEafMHYL0Sarrz5A7G79kXh5+5+woxQ5HM559XX2UZjMJ36Wplg==" crossorigin="anonymous">
</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
      <nav>
  <h1><a href="/">Solitude</a></h1>
  <a href="/">
    
    <img src="/assets/images/tree-160.jpg" id="solitude-logo" alt="Solitude logo"/>
    
  </a>
  <div id="bio">
    <p>Technology. Code. Living relentlessly in the real world.</p>
  </div>
  <nav>
    <ul>
      <li><a href="/about/">About</a></li>
      <li><a href="/Archives/">Archives</a></li>
    </ul>
  </nav>
  <div id="social">
    Follow me:
<div id="stalker">
  

  

  

  

  

  
  <a title="garyfleming on Twitter" href="https://twitter.com/garyfleming">
    <i class="fa fa-twitter-square"></i>
  </a>
  

  

  

  

  

  

  
  <a title="Atom feed" id="atom" href="/feed.xml">
    <i class="fa fa-rss-square"></i>
  </a>
  
</div>

  </div>
  
</nav>

    </div>

    <div class="eleven columns content">
      <div id="home">
  <h2><i class="fa fa-bookmark"></i> Happenings</h2>

  
  <div class="postcontainer">
  <h3><a href="/Archives/2008/08/19/fixing-a-gap-in-javascript/">Fixing a Gap in Javascript</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>An interesting problem: a bunch of <a href="http://struts.apache.org/1.2.8/userGuide/dev_nested.html">Struts Nested</a> tags generate HTML. Separately, we write some Javascript that makes use of <code class="language-plaintext highlighter-rouge">getElementById()</code> to find some of the generated elements. This works in Internet Explorer, but fails miserably in <a href="http://www.mozilla.com/firefox/">FireFox</a>. Why?</p>

<p>Well, it turns out that Struts Nested tags generate elements that have a <code class="language-plaintext highlighter-rouge">name</code> attribute but not an <code class="language-plaintext highlighter-rouge">id</code>. Separately, IE actually does the wrong thing with <code class="language-plaintext highlighter-rouge">getElementById()</code>: if a search by id fails, it will try to match by name; that’s fundamentally broken. It’d be fine if a bunch of libraries and other functions didn’t prefer the use of ids, and if other browsers did the same thing. They don’t and we’re stuck with the mess. Let’s clean it up.</p>

<p>The right thing to do would be to <a href="http://www.sixteensmallstones.org/ie-javascript-bugs-overriding-internet-explorers-documentgetelementbyid-to-be-w3c-compliant-exposes-an-additional-bug-in-getattributes">cripple the IE version into the correct behaviour</a>. Now everyone agrees on what should happen.</p>

<p>Let’s assume, though, that this isn’t possible, that there’s a large dependency on this behaviour that cannot be changed for whatever reason: no access to the JS, unwieldy codebase that we don’t have time to fix straight away (bad!), or something else. It’s not really that important. If you need to go for the wrong solution, here’s how:</p>

<p>`</p>
<pre>
document.nativeGetById = document.getElementById;
document.getElementById = function(id){
  var el = document.nativeGetById(id);
  if(el == null){
    el = document.getElementsByName(id)[0];
    if(el != null){el.id=id;}
  }
  return el;
}
</pre>
<p>`

That&#8217;ll work and it&#8217;ll even make sure subsequent calls use the native version of the function for extra speed. Now, there are a couple of small issues with this function and some pretty obvious optimisations, but I&#8217;ll leave that as an exercise for the reader.
</p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
  <div class="postcontainer">
  <h3><a href="/Archives/2008/08/12/neater-java/">Neater Java</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>In Java 5, as all good Java developers will know, Sun introduced the <code class="language-plaintext highlighter-rouge">enum</code> type. Since I’m sure anyone who is interested in what will follow knows that already, I won’t bore you with the details but there’s some decent <a href="http://java.sun.com/j2se/1.5.0/docs/guide/language/enums.html">historical information on Sun’s reasons</a> available. I’m going to be talking a little bit about operations on enums, so let’s get started by defining one:</p>

<p>`</p>
<pre>public enum OrderState{
PENDING, CHECKING_CREDIT, PROCESSING, SHIPPED, RECEIVED, CANCELLED, RETURNED
}</pre>
<p>`

Each of those items in the enumeration represent some state that an order can be in; an order being anything you can buy from an online store. We&#8217;re also going to have a variable called `currentState` which will hold one of these enumerated items. Let&#8217;s not think too hard about how accurate the model is, it&#8217;s really just there as a simple example.

Now imagine that one of our requirements is to enable a button if the currentState is one of several possible states, but not in any other state. For example, the &#8220;Cancel&#8221; button is enabled while the current state is `PENDING`, `PROCESSING`, or `CHECKING_CREDIT`. We&#8217;re doing a containment check, a pretty common operation. The standard Java approach would be:


`
<pre>if(currentState.equals(Order_State.PENDING)|| currentState.equals(Order_State.PROCESSING)|| currentState.equals(Order_State.CHECKING_CREDIT)){
    cancelButton.enable();
}</pre>
<p>`

Yuck! It gets the job done but that is some verbose and ugly code. We know that there&#8217;s got to be a better way, and there is: the [EnumSet](http://java.sun.com/j2se/1.5.0/docs/api/java/util/EnumSet.html) class. EnumSet is a somewhat overlooked Set implementation, specifically for grouping together items from the same Enum. I&#8217;ll let you look into the details of the API, but there are some very handy methods, such as `range()` and `complementOf()`. As a bonus, they&#8217;re also very efficient. How would our example look using an EnumSet?


`
<pre>if(EnumSet.of(Order_State.PENDING, Order_State.PROCESSING, Order_State.CHECKING_CREDIT).contains(currentState)){
    cancelButton.enable();
}</pre>
<p>`

That&#8217;s much better. Rather than a bunch of ORs that look disconnected and have a lot of repeated syntax, we state pretty clearly what we want: build a set of states, and then see whether the current state is part of that set.

There is another neater way of doing this, purely in terms of how syntactically nice it looks, though it requires a little helper function in the Enum. Add the following `in()` method directly to the Enum type:


`
<pre>public boolean in(Order_State... args){
    return EnumSet.copyOf(Arrays.asList(args)).contains(this);
}</pre>
<p>`

Now, we can do our contains check like this:


`
<pre>if(currentState.in(Order_State.PENDING, Order_State.PROCESSING, Order_State.CHECKING_CREDIT)){
    cancelButton.enable();
}</pre>
<p>`

Very tidy: we&#8217;ve got a single method call that expresses exactly what we&#8217;re aiming for in a fluent manner. Now, it does have it&#8217;s downsides like the helper function in the enum, and the fact that EnumSet is more efficient. I&#8217;d suggest, though, that in 99% of cases you&#8217;re not going to be caring about those few extra nanoseconds required to convert to a List first, and that the few seconds of developer time you save every time someone has to read and understand each version more than makes up for it.
</p></p></p></p></p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
  <div class="postcontainer">
  <h3><a href="/Archives/2008/07/20/postcode-lookups-suck/">Postcode Lookups Suck</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>Websites which have address forms for UK residences, whether for buying new products, paying bills or registering interest, I have a simple request: do not presume your database knows my address better than me.</p>

<p>For the benefit of non-UK readers, let me explain. The UK has a system originally designed for mail delivery called the Postcode, which is similar to the US zip code system. Unlike zip codes, it’s far more granular, generally resolving to a handful of addresses. In fact, most of the time, if you have a post code and house number, you can uniquely identify a particular delivery address. That’s all that is needed: a <strong>G1 4BQ</strong> and a <strong>35</strong>.</p>

<p>In 7 characters, most people can be readily identified. That’s the <a href="http://puffbox.com/2008/06/23/the-power-of-postcodes/">power of postcodes</a>.</p>

<p>A lot of UK websites take this as an absolute fact with no room for error. They take the data from the Post Office, see that it works for them, and forget about it. You either fit the pattern, or your house doesn’t exist. I’m sure you can see where I’m going with this.</p>

<p>One big problem is that large parts of the UK have some form of communal housing: tenement blocks, modern apartment blocks, high-rises etc. This is where things break down. As well as having a house number (the 35 above), they will also have a flat number like 3/2 (floor 3, flat 2), 4D (floor 4, flat D) or any other variation on the above. This is where things get very hairy:</p>

<ul>
  <li>Most post-code lookup systems will offer you a list of possible matches, which often miss some of the variations. That’s incomplete reference data.</li>
  <li>Most post-code lookup systems are never given updated data (compile once and you’re done). That’s poor data management.</li>
  <li>Most post-code lookup systems don’t allow for changes to addresses. That’s, again, poor data management.</li>
  <li>Most systems don’t allow for even more complex forms, where a flat has a house number (35, two part flat number (3/2), and a block number (D); the combinations of these can come in endless forms (D3/2, 35 Example St vs. Flat 2, Floor 3, Block D, 35 Example St).</li>
</ul>

<p>Most systems will fall flat in the face of any of these. While fixing these problems directly is hard (to near enough impossible), there’s a very simple solution originally posited by Postel:</p>

<blockquote>
  <p>Be conservative in what you do; be liberal in what you accept from others</p>
</blockquote>

<p>Yes, it’s the simple: just accept whatever your users, <em>the people who live at the address</em>, put into your form. They know the correct answer far better than you ever will, so believe them when they put something in. If you want to help them by offering a post-code lookup, that’s fine, encouraged even; but don’t insist that they use it. That just hurts the usability of your system.</p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
  <div class="postcontainer">
  <h3><a href="/Archives/2008/07/17/film-fight-june-2008/">Film Fight: June 2008</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>5 more films for the fight…</p>

<p><strong>Gone Baby Gone</strong> is the long delayed directorial debut of Ben Affleck (delayed due to the theme of child kidnapping being a little too close to the bone over the last year), and as debuts go it’s not bad. The mainstay of the plot is reasonable enough: kid gets kidnapped, private investigators who know the locals get involved, there’s more than meets the eye. The performances are for the most part decent, with one outstanding performance put in by Ed Harris; one scene in particular, we see some absolute brilliance in his act. All that said, the film is too clever for its own good. There are too many attempts at pulling the wool over the audiences eyes or twisting a little bit too much for comfort. A shame, because the film is solid, if nothing outstanding.</p>

<p>With the bar set to ridiculously low by Ang Lee’s <a href="/Archives/2003/08/02/Hulkish/">Hulk</a>, the franchise reboot starring Ed Norton doesn’t really have to work all that hard to improve. <strong>The Incredible Hulk</strong> is, then, a pleasant surprise, in that it manages to get a lot of things right for the genre. It doesn’t waste time on back story, origins or explaining relationships that are apparent by the interactions, accepting that people know everything they need to know about the Hulk mythos already. It gets moving, keeps a steady enough pace, holds interest, and then plummets with the action sequences towards the end. Sorry, but two CGI monsters who are not grounded in any approachable form of physics break any suspension of disbelief. It had been beating expectations until the final scenes, so to see a mindless fight that turns around for no good reason is a real waste.</p>

<p>Imagine, for a second, taking an entire season of Prison Break and cramming it into 100 minutes; no wasting time on pointless threads that spur things on, no wasted attempts and feeling cheated by do-overs, just the escape: welcome to <strong>The Escapist</strong>. Although it falls into a Brit crime caper directorial style at times, it manages to show a surprisingly amount of depth and care. The editing is also inspired. While often cutting early parts of a story (chronologically speaking) in amongst the ending is often just an awkward gimmick, cutting the escape and it’s problems in amongst the planning scenes is surprisingly effective. In places that would otherwise be dead weight, tension is kept high. The “But”? The very final moments of the film pull back a needless reveal that cheapens the whole. Without it, it’d be a strong film.</p>

<p>The second of the Narnia films is, unexpectedly, worse than the first entry. <strong>Prince Caspian</strong> is relatively rich source material (caveats about CS Lewis’ various leanings aside), so it’s disappointing to see such uninspired cinema. We have a largely fluffer plot, terrible performances (some of the kids have gotten worse), dreadful accents, poor CGI battles and an afterthought love interest. If it wasn’t for the cute mice, there’d be next to nothing good to say here. Not worth seeing.</p>

<p>Finally, <strong>Wanted</strong> is the Hollywood debut of Timur Bekmambetov, previously of Night Watch/Day Watch fame. Based, barely, on a graphic novel of the same name, Wanted is about a fraternity of assassins who follow the path set out by the seemingly random machinations of fate and them bringing someone into the fold who begins to disrupt their way of life. There’s plenty you could do with that as source material but sadly Timur has opted to make yet another piss-poor CGI heavy action yawnfest. The inconsistencies in this film make it painful to watch, the accents are atrocious (I’ve seen James McAvoy act elsewhere, what happened here?), and the whole thing turgid. There’s nothing worthwhile to recommend this film. It fails as an action film, as a story, and on every other level a film can. Awful.</p>

<p>So, despite a regrettable finale, <strong>The Escapist</strong> is this months winner!</p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
  <div class="postcontainer">
  <h3><a href="/Archives/2008/07/06/film-fight-may-2008/">Film Fight: May 2008</a></h1>
  <p class="author">
    <span class="date"> </span>
  </p>
  <div class="post">
    <p>Another month, another 4 films…</p>

<p><strong>Iron Man</strong> is the first film in Marvel’s attempt to reboot their film universe, after some fairly awful entries. The failings of this film are the same for most Hollywood action films: they’re made for what is expected to be the lowest common denominator (that great, traditional cinema has a more universal appeal is a debate for another post, but think of something like Goodfellas). The plot is fairly moronic, being nothing more than an attempt to tell the origin story quickly and get onto a series of CGI action sequences and cameos (for other Marvel characters). Big, loud, and fast. As the genre goes, it’s not a terrible entry: Robert Downey Jr. is an inspired choice, even if Tony Stark has gone from obsessive alcoholic genius, the prototypical flawed hero, to brash-but-brilliant, crowd-pleasing asshole. Where it lacks good storytelling, it makes some inroads with the action. Watchable.</p>

<p>The quiet, British indie film, <strong>Cashback</strong>, has a decent premise: an art student obsesses over the female form (while working in a supermarket), often stopping time to fully indulge his compulsion. It’s left purposefully opaque as to the extent and reality of this talent, flipping back and forth between assuming it’s real or just his imagination. That’s fine though: the frozen time scenes are merely a mechanism for exploring the character, and on that level the film is a success. Cashback suffers from being stretched too thin (perhaps as a result of being an expanded version of a short film) as some of the other characters and the plot lines are shoe-horned in or lack depth, notably his best friend. Still, it’s a decent enough film when it focusses on it’s stronger parts.</p>

<p>Here’s a concept: a horror film where it is abundantly clear that the nemesis, whether ghost, monster or zombie, has the main characters in a place where it can’t be stopped, hurt or, for the most part, seen. <strong>Outpost</strong> is that movie. You may think that this would make for quite a dramatic, fraught, survival piece but the opposite is true: it lacks tension or scares, and sadly lacks a coherent plot. For some reason, the Nazi ghosts are murdering a group of soldiers who stumble upon an abandoned bunker, making for some of the most conveniently capricious baddies you’re likely to see. They can kill everyone at any time, but stick with one at a time kills until the plot calls for more. There are some decent elements (the creepy pale man) but they’re never utilised as fully as they could be. Relatively weak.</p>

<p>Finally, the much awaited <strong>Indiana Jones and the Kingdom of the Crystal Skull</strong> shows that even the relatively sacred Indiana Jones franchise is capable of producing an absolute stinker. There is little to like about this film. The story is nonsensical, fan-pleasing hookum in the worst sense. It reads like fan fiction. You expect the author’s favourite band to turn up and high-five Shia LaBeouf (who is awful in this), it’s honestly that bad. The fun, family adventures (occult themes not withstanding) have been replaced by farce. The impeccably solid stunt-work has been replaced by piss weak CGI and ludicrous ideas. The evil ants climb up each other like a cartoon? Shia LeBeouf becomes Tarzan? <em>That</em> accent was supposed to be acting? Tragically bad, and not so tragic that it’s funny either.</p>

<p>The winner for May 2008 is <strong>Cashback</strong>. It wouldn’t have won in many other months, but it’s core is a good enough film to warrant a watch.</p>

  </div>
  <div class="divider"><img src="/assets/images/divider.png" /></div>
  </div>
  
</div>



<!-- Pagination links -->
<div class="postnavigation">
  
    <a href="/page/42" class="previous">&laquo; Previous</a>
  
  
    <a href="/page/44" class="next">Next &raquo;</a>
  
</div>


      <div class="footer">
        <div class="disclaimer">
  

  <p>
    © Solitude, 2003-20 &mdash; built with <a href="http://jekyllrb.com/">Jekyll</a>, using <a href="https://github.com/swanson/lagom">Lagom</a> as a base theme.
  </p>
</div>
      </div>
    </div>
  </div>


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11493178-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
